<html>
<head>
   <title>Простые вложенные подзапросы</title>

</head>
<body background="fon.jpg">
<div align="center"><b><font>3.3.2. Простые вложенные подзапросы</font></b></div><font size = "-1">

<p align=justify>Простые вложенные подзапросы используются для представления множества значений, исследование которых должно осуществляться в каком-либо предикате IN, что иллюстрируется в следующем примере: выдать название и статус поставщиков продукта с номером 11, т.е. помидоров.</P>

<TABLE width=100%>
<TR><TH></TH><TH align=left>Результат:</TH></TR>
<TR><TD><PRE>
SELECT	Название, Статус
FROM	Поставщики
WHERE	ПС IN
	(	SELECT	ПС
		FROM	Поставки
		WHERE	ПР = 11 );</PRE></TD>
		
<TD>
<TABLE><TR><TH>Название</TH><th>Статус</TH></TR>
<TR><TD>СЫТНЫЙ</TD><TD>рынок</TD></TR>
<TR><TD>УРОЖАЙ</TD><TD>коопторг</TD></TR>
<TR><TD>ЛЕТО</TD><TD>агрофирма</TD></TR>
<TR><TD>КОРЮШКА</TD><TD>кооператив</TD></TR></TABLE>
</TD>
</TR>
</TABLE>

<p align=justify>Как уже отмечалось в п.<a href=3-3-1.htm>3.3.1</a>, при обработке полного запроса система выполняет прежде всего вложенный подзапрос. Этот подзапрос выдает множество номеров поставщиков, которые поставляют продукт с кодом ПР = 11, а именно множество (1, 5, 6, 8). Поэтому первоначальный запрос эквивалентен такому простому запросу:</P>
<PRE>
SELECT	Название, Статус
FROM	Поставщики
WHERE	ПС IN (1, 5, 6, 8);
</PRE>

<p align=justify>Подзапрос с несколькими уровнями вложенности можно проиллюстрировать на том же примере. Пусть требуется узнать не поставщиков продукта 11, как это делалось в предыдущих запросах, а поставщиков помидоров, являющихся продуктом с номером 11. Для этого можно дать запрос</P>

<PRE>
SELECT	Название, Статус
FROM	Поставщики
WHERE	ПС IN
	(	SELECT	ПС
		FROM	Поставки
		WHERE	ПР IN
			(	SELECT	ПР
				FROM	Продукты
				WHERE	Продукт = 'Помидоры' ));</PRE>

<p align=justify>В данном случае результатом самого внутреннего подзапроса является только одно значение (11). Как уже было показано выше, подзапрос следующего уровня в свою очередь дает в результате множество (1, 5, 6, 8). Последний, самый внешний SELECT, вычисляет приведенный выше окончательный результат. Вообще допускается любая глубина вложенности подзапросов.</P>
<p align=justify>Тот же результат можно получить с помощью соединения</P>
<PRE>
SELECT	Название, Статус
FROM	Поставщики, Поставки, Продукты
WHERE	Поставщики.ПС = Поставки.ПС
AND	Поставки.ПР = Продукты.ПР
AND	Продукт = 'Помидоры';
</PRE>

<p align=justify>При выполнении этого компактного запроса система должна одновременно обрабатывать данные из трех таблиц, тогда как в предыдущем примере эти таблицы обрабатываются поочередно. Естественно, что для их реализации тебуются различные ресурсы памяти и времени, однако этого невозможно ощутить при работе с ограниченным объемом данных в иллюстративной базе ПАНСИОН.</P>

<p align="center">
<a href="3-3-1.htm">3.3.1</a> | <a href="index.htm">Содержание</a> | <a href="3-3-3.htm">3.3.3</a>
</p>

</body>
</html>
