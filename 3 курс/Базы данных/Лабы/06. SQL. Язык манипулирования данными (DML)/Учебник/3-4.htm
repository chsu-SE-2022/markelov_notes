<html>
<head>
   <title>Объединение (UNION)</title>

</head>
<body background="fon.jpg">
<div align="center"><b><font>3.4. Объединение (UNION)</font></b></div><font size = "-1">


<p align=justify>В литературе [<a href=liter.htm>2</a>] рассматривалась реляционная операция "Объединение", позволяющая получить отношение, состоящее из всех строк, входящих в одно или оба объединяемых отношения. Но при этом исходные отношения или их объединяемые проекции должны быть совместимыми по объединению. Для SQL это означает, что две таблицы можно объединять тогда и только тогда, когда:</P>
<OL type=a>
<LI> они имеют одинаковое число столбцов, например, m;
<LI> для всех i (i = 1, 2, ..., m)  i-й столбец первой таблицы и i-й столбец второй таблицы имеют в точности одинаковый тип данных.</OL>
<p align=justify>Например, выдать названия продуктов, в которых нет жиров, либо входящих в состав блюда с кодом БЛ = 1:</P>

<TABLE width=100%>
<TR><TH></TH><TH align=right>	Результат:</TH><TH align=left>Продукт</TH></TR>
<TR valign=top><TD colspan=2><PRE>
SELECT	Продукт
FROM	Продукты
WHERE	Жиры = 0
UNION
SELECT	Продукт
FROM	Соста
WHERE	БЛ = 1</PRE></TD>
		
<TD>
<TABLE>
<TR><TD>Майонез</TD></TR>
<TR><TD>Лук</TD></TR>
<TR><TD>Помидоры		</TD></TR>
<TR><TD>Зелень</TD></TR>
<TR><TD>Яблоки</TD></TR>
<TR><TD>Сахар</TD></TR>
</TABLE>
</TD>
</TR>
</TABLE>

<p align=justify>Из этого простого примера видно, что избыточные дубликаты всегда исключаются из результата UNION. Поэтому, хотя в рассматриваемом примере Помидоры, Зелень и Яблоки выбираются обеими из двух составляющих предложения SELECT, в окончательном результате они появляются только один раз.</P>
<p align=justify>Предложением с UNION можно объединить любое число таблиц (проекций таблиц). Так, к предыдущему запросу можно добавить (перед точкой с запятой) конструкцию</P>
<PRE>
UNION
SELECT	Продукт
FROM	Продукты
WHERE	Ca &lt; 250
</PRE>

<p align=justify>позволяющую добавить к списку продуктов Масло, Рис, Мука и Кофе. Однако тот же результат можно получить простым изменением фразы WHERE первой части исходного запроса</P>

<PRE>
WHERE Жиры = 0  OR  Ca < 250</PRE>

<p align="center">
<a href="3-3-7.htm">3.3.7</a> | <a href="index.htm">Содержание</a> | <a href="3-5.htm">3.5</a>
</p>

</body>
</html>
