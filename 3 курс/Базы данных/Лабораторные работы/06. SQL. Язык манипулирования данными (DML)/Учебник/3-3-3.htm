<html>
<head>
   <title>Использование одной и той же таблицы во внешнем и вложенном подзапросе</title>

</head>

<body background="fon.jpg">
<div align="center"><b><font>3.3.3. Использование одной и той же таблицы во внешнем и вложенном подзапросе</font></b></div><font size = "-1">

<p align=justify>Выдать номера поставщиков, которые поставляют хотя бы один продукт, поставляемый поставщиком 6.</P>

<TABLE width=100%>
<TR><TH></TH><TH align=left>Результат:</TH></TR>
<TR valign=top><TD><PRE>
SELECT	DISTINCT ПС
FROM	Поставки
WHERE	ПР IN
	(	SELECT	ПР
		FROM	Поставки
		WHERE	ПС = 6);</PRE></TD>
		
<TD>
<TABLE><TR><TH>ПС</TH></TR>
<TR><TD>1</TD></TR>
<TR><TD>3</TD></TR>
<TR><TD>5</TD></TR>
<TR><TD>6</TD></TR>
<TR><TD>8</TD></TR>
</TABLE>
</TD>
</TR>
</TABLE>
<p align=justify>Отметим, что ссылка на Поставки во вложенном подзапросе означает не то же самое, что ссылка на Поставки во внешнем запросе. В действительности, два имени Поставки обозначают различные значения. Чтобы этот факт стал явным, полезно использовать псевдонимы, например, X и Y:</P>

<PRE>
SELECT	DISTINCT X.ПС
FROM	Поставки X
WHERE	X.ПР IN
	(	SELECT	Y.ПР
		FROM	Поставки Y
		WHERE	Y.ПС = 6 );</PRE>

<p align=justify>Здесь X и Y – произвольные псевдонимы таблицы Поставки, определяемые во фразе FROM и используемые как явные уточнители во фразах SELECT и WHERE. Напомним, что псевдонимы определены лишь в пределах одного запроса.</P>

<p align="center">
<a href="3-3-2.htm">3.3.2</a> | <a href="index.htm">Содержание</a> | <a href="3-3-4.htm">3.3.4</a>
</p>

</body>
</html>
