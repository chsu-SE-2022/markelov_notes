<html>
<head>
   <title>Соединение таблицы со своей копией</title>

</head>

<body background="fon.jpg">
<div align="center"><b><font>3.2.7. Соединение таблицы со своей копией</font></b></div><font size = "-1">

<p align=justify>В ряде приложений возникает необходимость одновременной обработки данных какой-либо таблицы и одной или нескольких ее копий, создаваемых на время выполнения запроса.</P>
<p align=justify>Например, при создании списков студентов (таблица Студенты) возможен повторный ввод данных о каком-либо студенте с присвоением ему второго номера зачетной книжки. Для выявления таких ошибок можно соединить таблицу Студенты с ее временной копией, установив в WHERE фразе равенство значений всех одноименных столбцов этих таблиц кроме столбцов с номером зачетной книжки (для последних надо установить условие неравенства значений).</P>
<p align=justify>Временную копию таблицы можно сформировать, указав имя псевдонима за именем таблицы во фразе FROM. Так, с помощью фразы</P>

<PRE>
FROM Блюда X, Блюда Y, Блюда Z</PRE>

будут сформированы три копии таблицы Блюда с именами X, Y и Z.
<p align=justify>В качестве примера соединения таблицы с ней самой сформируем запрос на вывод таких пар блюд таблицы Блюда, в которых совпадает основа, а название первого блюда пары меньше (по алфавиту), чем номер второго блюда пары. Для этого можно создать запрос с одной копией таблицы Блюда (Копия):
</P>
<PRE>
SELECT	Блюдо, Копия.Блюдо, Основа
FROM	Блюда, Блюда Копия
WHERE	Основа = Копия.Основа
AND	Блюдо &lt; Копия.Блюдо;</PRE>

<P>или двумя ее копиями (Первая и Вторая):</P>
<PRE>
SELECT	Первая.Блюдо, Вторая.Блюдо, Основа
FROM	Блюда Первая, Блюда Вторая
WHERE	Первая.Основа = Вторая.Основа
AND	Первая.Блюдо &lt; Вторая.Блюдо;</PRE>

<P>Получим результат вида</P>
<TABLE>
<TR><th>Первая.Блюдо</TH><th>Вторая.Блюдо</TH><th>Основа</TH></TR>
<TR><TD>Морковь с рисом</TD><TD>Помидоры с луком</TD><TD>Овощи</TD></TR>
<TR><TD>Морковь с рисом</TD><TD>Салат летний</TD><TD>Овощи</TD></TR>
<TR><TD>Морковь с рисом</TD><TD>Салат витаминный</TD><TD>Овощи</TD></TR>
<TR><TD>Помидоры с луком</TD><TD>Салат витаминный</TD><TD>Овощи</TD></TR>
<TR><TD>Помидоры с луком</TD><TD>Салат летний</TD><TD>Овощи</TD></TR>
<TR><TD>Салат витаминный</TD><TD>Салат летний</TD><TD>Овощи</TD></TR>
<TR><TD>Бастурма</TD><TD>Бефстроганов</TD><TD>Мясо</TD></TR>
<TR><TD>Бастурма</TD><TD>Мясо с гарниром</TD><TD>Мясо</TD></TR>
<TR><TD>Бефстроганов</TD><TD>Мясо с гарниром</TD><TD>Мясо</TD></TR>
</TABLE>


<p align="center">
<a href="3-2-6.htm">3.2.6</a> | <a href="index.htm">Содержание</a> | <a href="3-3-1.htm">3.3.1</a>
</p>

</body>
</html>
