<html>
<head>
   <title>Предложение INSERT</title>

</head>

<body background="fon.jpg">
<div align="center"><b><font>4.3. Предложение INSERT</font></b></div><font size = "-1">
<div align="center"><b><font>4.3.1. Вставка единственной записи в таблицу</font></b></div><font size = "-1">

<p align=justify>Добавить в таблицу Блюда блюдо:</p>
<pre>
Шашлык (БЛ - 34, Блюдо - Шашлык, В - Г, 
                      Основа - Мясо, Выход - 150)
</pre>
<p align=justify>при неизвестной пока трудоемкости приготовления этого блюда.</p>
<pre>
INSERT
INTO	Блюда (БЛ, Блюдо, В, Основа, Выход)
VALUES	(34, 'Шашлык', 'Г', 'Мясо', 150);
</pre>
<p align=justify>Создается новая запись для блюда с номером 34, с неопределенным значением в столбце Труд.</p>
<p align=justify>Порядок полей в INSERT не обязательно должен совпадать с порядком полей, в котором они определялись при создании таблицы. Вполне допустима и такая версия предыдущего предложения:</p>
<pre>
INSERT
INTO	Блюда (Основа, В, Блюдо, БЛ, Выход)
VALUES	('Мясо', 'Г', 'Шашлык', 34, 150);
</pre>
<p align=justify>При известной трудоемкости приготовления шашлыка (например, 5 коп) сведения о нем можно ввести с помощью укороченного предложения:</p>
<pre>
INSERT
INTO	Блюда
VALUES	(34, 'Шашлык', 'Г', 'Мясо', 150, 5);
</pre>
<p align=justify>в котором должен соблюдаться строгий порядок перечисления вводимых значений, так как, не имея перечня загружаемых столб-цов, СУБД может использовать лишь перечень, который определен при создании модифицируемой таблицы.</p>
<p align=justify>В предыдущих примерах проводилась модификация стержневой сущности, т.е. таблицы с первичным ключом БЛ (см.п.2.4 в литературе [<a href=liter.htm>2</a>]). Почти все СУБД имеют механизмы для предотвращения ввода не уникального первичного ключа, например, ввода "Шашлыка" под номером, меньшим 34. А как быть с ассоциациями или другими таблицами, содержащими внешние ключи?</p>
<p align=justify>Пусть, например, потребовалось добавить в рецепт блюда Салат летний (БЛ = 1) немного (15 г) лука (ПР = 10), и мы воспользовались предложением</p>
<pre>
INSERT
INTO	Состав (БЛ, ПР, Вес)
VALUES	(1, 10, 15);
</pre>
<p align=justify>Подобно операции DELETE операция INSERT может нарушить непротиворечивость базы данных. Если не принять специальных мер, то СУБД не проверяет, имеется ли в таблице Блюда блюдо с первичным ключом БЛ = 1 и в таблице Продукты - продукт с первичным ключом ПР = 10. Отсутствие любого из этих значений породит противоречие: в базе появится ссылка на несуществующую запись. Проблемы, возникающие при использовании внешних ключей, подробно рассмотрены в литературе [<a href=liter.htm>2</a>], а здесь отме-тим, что все "приличные" СУБД имеют механизмы для предотв-ращения ввода записей со значениями внешних ключей, отсутст-вующих среди значений соответствующих первичных ключей.</p>

<p align="center">
<a href="4-2.htm">4.2</a> | <a href="index.htm">Содержание</a> | <a href="4-3-2.htm">4.3.2</a>
</p>

</body>
</html>
