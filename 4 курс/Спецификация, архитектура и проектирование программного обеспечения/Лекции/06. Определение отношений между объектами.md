После определения основных пакетов разрабатываемого программного обеспечения переходят к детальному проектированию классов, входящих в каждый пакет. Классы-кандидаты, которые предположительно должны войти в конкретный пакет; показывают на диаграмме классов этапа проектирования и уточняют отношения между объектами указанных классов.  
**Пример 1.** Определить классы-кандидаты пакета Объекты задачи.  
Выполним анализ концептуальной модели предметной области, описания основного варианта использования Решение задачи и его диаграммы деятельностей.  
Список классов-кандидатов, полученный на основе данного анализа, выглядит следующим
образом:
- класс Задание - объекты данного класса должны создаваться каждый раз, когда пользователь инициирует новое задание
- семейство классов с базовым классом Алгоритм - объекты данного класса должны создаваться, когда определен алгоритм решения задачи
- класс Данные - объекты данного класса должны создаваться при определении (вводе или выборе из базы) данных
- класс Результаты - объекты данного класса должны создаваться при решении конкретной задачи конкретным алгоритмом с использованием конкретных данных
  
Исходный вариант диаграммы классов пакета Объекты задачи:  
![Исходная диаграмма классов пакета Объекты задачи](../Pictures/06_01.%20Исходная%20диаграмма%20классов%20пакета%20Объекты%20задачи.png)  
Основой для проектирования классов является уточнение взаимодействия объектов этих классов в процессе реализации вариантов использования. При этом применяют диаграммы последовательностей и диаграммы кооперации. Если же необходимо описать взаимодействие объектов при обработке конкретного сообщения, удобны именно диаграммы последовательностей.  
## Диаграмма последовательностей этапа проектирования
Диаграммы последовательностей этапа проектирования отображают взаимодействие объектов, упорядоченное по времени. В отличие от диаграмм последовательности этапа анализа на ней показывают внутренние объекты, а также последовательность сообщений, которыми обмениваются объекты в процессе реализации фрагмента варианта использования, называемого сценарием.  
Объекты изображают в виде прямоугольников, внутри которого указана информация, идентифицирующая объект: 
- Имя объекта:  
	![Условные обозначения объектов в UML - объект](../Pictures/06_02.%20Условные%20обозначения%20объектов%20в%20UML%20-%20объект.png)
- Имя объекта и имя класса:  
	![Условные обозначения объектов в UML - объект с уточнением класса](../Pictures/06_03.%20Условные%20обозначения%20объектов%20в%20UML%20-%20объект%20с%20уточнением%20класса.png)
- Только имя класса:  
	![Условные обозначения объектов в UML - непоименованный объект указанного класса](../Pictures/06_04.%20Условные%20обозначения%20объектов%20в%20UML%20-%20непоименованный%20объект%20указанного%20класса.png)
Каждое сообщение представляют в виде линии со стрелкой, соединяющей линии жизни двух объектов. Эти линии помещают на диаграмму в порядке генерации сообщений (сверху вниз и слева направо). Сообщению присваивают имя, но можно указать и аргументы, и управляющую информацию, например, условие формирования или маркер итерации (`*`). Возврат при передаче синхронных сообщений подразумевают по умолчанию.  
Если объект создается сообщением, то его рисуют справа от стрелки сообщения так, чтобы стрелка сообщения входила в него слева.  
Диаграммы последовательностей также позволяют изображать параллельные процессы. **Асинхронные сообщения**, которые не блокируют работу вызывающего объекта, показывают половинкой стрелки:  
![Условные обозначения асинхронных передач управления - асинхронное сообщение](../Pictures/06_05.%20Условные%20обозначения%20асинхронных%20передач%20управления%20-%20асинхронное%20сообщение.png)  
Такие сообщения могут:
- создавать новую ветвь процесса
- создавать новый объект:  
	![Условные обозначения асинхронных передач управления - создание объекта](06_06.%20Условные%20обозначения%20асинхронных%20передач%20управления%20-%20создание%20объекта.png)
- устанавливать связь с уже выполняющейся ветвью процесса
  
На линии жизни в этом случае дополнительно показывают активации, которые обозначаются прямоугольником, наложенным поверх линии жизни:  
![Условные обозначения асинхронных передач управления - активация объекта](../Pictures/06_07.%20Условные%20обозначения%20асинхронных%20передач%20управления%20-%20активация%20объекта.png)  
Уничтожение объекта показывают большим знаком "X":  
![Условные обозначения асинхронных передач управления - уничтожение объекта](../Pictures/06_08.%20Условные%20обозначения%20асинхронных%20передач%20управления%20-%20уничтожение%20объекта.png)  
При необходимости линию жизни можно прервать, чтобы не уточнять обработку, не связанную с анализируемыми объектами:  
![Условные обозначения асинхронных передач управления - разрыв](../Pictures/06_09.%20Условные%20обозначения%20асинхронных%20передач%20управления%20-%20разрыв.png)  
**Пример 2.** Разработать диаграмму последовательностей для сценария Решение задачи (фрагмент варианта использования Выполнение задания от момента инициализации пользователем процесса решения до его завершения).  
Анализ описания варианта использования показывает, что необходимо рассмотреть три варианта последовательности действий:
1. Нормальный процесс
2. Прерывание процесса пользователем
3. Возникновение исключения при выполнении алгоритма
  
Нормальный процесс предполагает, что при выдаче команды Создать создается объект Решение, управляющий данным сценарием. Следующее сообщение Начать активизирует этот объект. Объект Решение запрашивает у объекта класса Задание тип объекта Алгоритм, создает объект требуемого класса и активизирует его, сохраняя способность получать и обрабатывать сообщения (параллельный процесс).  
Объект класса Алгоритм, реализующий метод, запрашивает у объекта класса Задание данные и начинает обработку, используя вспомогательные объекты. Нормально завершив обработку, объект класса Алгоритм, реализующий метод, передает объекту класса Задание результаты и возвращает объекту Решение признак нормального завершения. Объект Решение уничтожает объект класса Алгоритм, реализующий метод, и возвращает вызвавшему его объекту признак нормального завершения решения:  
![Диаграмма последовательности действий сценария Процесс решения - нормальный процесс](../Pictures/06_10.%20Диаграмма%20последовательности%20действий%20сценария%20Процесс%20решения%20-%20нормальный%20процесс.png)  
В случае прерывания процесса объект Решение прерывает процесс решения, уничтожает
объект Алгоритм и возвращает признак прерванного выполнения:  
![Диаграмма последовательности действий сценария Процесс решения - прерывание процесса пользователем](../Pictures/06_11.%20Диаграмма%20последовательности%20действий%20сценария%20Процесс%20решения%20-%20прерывание%20процесса%20пользователем.png)  
В этом случае при выполнении обработки возникает аварийная ситуация, результатом которой является генерация исключения. Обрабатывая исключение, объект класса Решение, генерирует соответствующее сообщение пользователю, уничтожает объект класса Алгоритм, реализующий метод, и возвращает признак завершения выполнения с ошибкой:  
![Диаграмма последовательности действий сценария Процесс решения - возникновение исключения](../Pictures/06_12.%20Диаграмма%20последовательности%20действий%20сценария%20Процесс%20решения%20-%20возникновение%20исключения.png)  
## Диаграмма кооперации
**Диаграмма кооперации** - это альтернативный способ представления взаимодействия объектов в процессе реализации сценария, который позволяет по-другому взглянуть на ту же информацию. В отличие от диаграмм последовательностей диаграммы кооперации показывают потоки данных между объектами классов, что позволяет уточнить связи между ними.  
**Пример 3.** Разработать диаграмму кооперации для сценария Процесс решения. Изобразим на одной диаграмме 3 возможных случая реализации сценария, нумеруя сообщения в порядке их возможной генерации:  
![Диаграмма кооперации сценария Процесс решения](../Pictures/06_13.%20Диаграмма%20кооперации%20сценария%20Процесс%20решения.png)  
Такое представление позволяет описать потоки данных, передаваемых между объектами классов Решение, Задание и Алгоритм, реализующий метод, для сценария Процесс решения.