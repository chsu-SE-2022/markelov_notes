<html>
<head>
   <title>Использование BETWEEN</title>

</head>

<body background="fon.jpg">
<div align="center"><b><font> 2.3.2. Использование BETWEEN</font></b></div><font size = "-1">

<p align=justify>С помощью BETWEEN ... AND ... (находится в интервале от ... до ...) можно отобрать строки, в которых значение какого-либо столбца находятся в заданном диапазоне.</P>
Например, выдать перечень продуктов, в которых значение содержания белка находится в диапазоне от 10 до 50:						
<TABLE BORDER=0 width=100%>
<TR><TH align=left></TH><TH colspan=2>Результат:</TH>
<TR valign=top><TD rowspan=7>
<PRE>
SELECT	Продукт, Белки
FROM	Продукты
WHERE 	Белки BETWEEN 10 AND 50;</PRE> </TD>
<TR><TH align=left>Продукт</TH>	<TH align=left>Белки</TH></TR>
<TR><TD>Майонез</TD><TD>31.</TD></TR>
<TR><TD>Сметана</TD><TD>26.</TD></TR>
<TR><TD>Молоко</TD><TD>28.</TD></TR>
<TR><TD>Морковь</TD><TD>13.</TD></TR>
<TR><TD>Лук</TD><TD>17.</TD></TR>
</TR>
</TABLE>
<p align=justify>Можно задать и NOT BETWEEN (не принадлежит диапазону между), например:</P>
<TABLE BORDER=0 width=100%>
<TR><TH align=left></TH><TH colspan=2>Результат:</TH>
<TR valign=top><TD rowspan=4>
<PRE>
SELECT	Продукт, Белки, Жиры
FROM	Продукты	
WHERE	Белки NOT BETWEEN
                10 AND 50	
AND	Жиры > 100;</PRE></TD>
<TR><TH align=left>Продукт</TH>	<TH align=left>Белки</TH> <TH align=left>Жиры</TH> </TR>	
<TR><TD>Говядина</TD><TD>189.</TD><TD>124.</TD></TR>
<TR><TD>Масло</TD><TD> 60.</TD><TD>825.</TD></TR>
<TR><TD>Яйца</TD><TD>127.</TD><TD>115.</TD></TR>
</TR>
</TABLE>

<p align=justify>BETWEEN особенно удобен при работе с данными, задаваемыми интервалами, начало и конец которых расположен в разных столбцах.</P>
<p align=justify>Для примера воспользуемся таблицей "минимальных окладов" (табл. 2.1), величина которых непосредственно связана со студенческой стипендией. В этой таблице для текущего значения минимального оклада установлена запредельная дата окончания 9 сентября 9999 года.</P>

<p align=center><I>Таблица 2.1</I>
<BR><I>Минимальные оклады </I></P>
<CENTER><TABLE>
<TR><TH align=left>Миноклад</TH><TH align=left>Начало</TH><TH align=left>Конец</TH></TR>
<TR><TD>2250</TD><TD>01-01-1993</TD><TD>31-03-1993</TD>  </TR>
<TR><TD>4275</TD><TD>01-04-1993</TD><TD>30-06-1993</TD>  </TR>
<TR><TD>7740</TD><TD>01-07-1993</TD><TD>30-11-1993</TD>  </TR>
<TR><TD>14620</TD><TD>01-12-1993</TD><TD>30-06-1994</TD>  </TR>
<TR><TD>20500</TD><TD>01-07-1994</TD><TD>09-09-9999</TD>  </TR>
</TABLE></CENTER>

<p align=justify>Если, например, потребовалось узнать, какие изменения минимальных окладов производились в 1993/94 учебном году, то можно выдать запрос</P>

<PRE>
SELECT	Начало, Миноклад
FROM	Миноклады
WHERE	Начало BETWEEN '1-9-1993' AND '31-8-1994'</PRE>
и получить результат:

<TABLE>
<TR><TH align=left>Начало</TH><TH align=left>Миноклад</TH></TR>
<TR><TD>01-12-1993</TD><TD>14620</TD></TR>
<TR><TD>01-07-1994</TD><TD>20500</TD></TR>
</TABLE>

<p align=justify>Отметим, что при формировании запросов значения дат следует заключать в апострофы, чтобы СУБД не путала их с выражениями и не пыталась вычитать из 31 значение 8, а затем 1994.</P>
<p align=justify>Для выявления всех значений минимальных окладов, которые существовали в 1993/94 учебном году, можно сформировать запрос</P>

<PRE>
SELECT	*
FROM	Миноклады
WHERE	Начало	BETWEEN '1-9-1993' AND '31-8-1994'
OR	Конец 	BETWEEN '1-9-1993' AND '31-8-1994'</PRE>

<TABLE>
<TR><TH align=left>Миноклад</TH><TH align=left>Начало</TH><TH align=left>Конец</TH></TR>
<TR><TD>7740</TD><TD>01/07/1993</TD><td>30/11/1993</TD></TR>
<TR><TD>14620</TD><TD>01/12/1993</TD><td>30/06/1994</TR>
<TR><TD>20500</TD><TD>01/07/1994</TD><td>09/09/9999</TR>
</TABLE>

<p align=justify>Наконец, для получения минимального оклада на 15-5-1994:</P>
<TABLE BORDER=0 width=100%>
<TR><TH align=left></TH><TH colspan=2>Результат:</TH>
<TR valign=top><TD rowspan=3>
<PRE>
SELECT	Миноклад
FROM	Миноклады
WHERE	'15-05-1994' BETWEEN Начало AND Конец</PRE></td>
<TR><TH align=left>Миноклад</TH>
<TR><TD>14620</TD></TR>
</TR>
</table>

<p align="center">
<a href="2-3-1.htm">2.3.1</a> | <a href="index.htm">Содержание</a> | <a href="2-3-3.htm">2.3.3</a>
</p>

</body>
</html>
