<html>
<head>
   <title>Предложения модификации данных SQL</title>

</head>
<body background="fon.jpg">
<div align="center"><b><font>Глава 4. Предложения модификации данных SQL</font></b></div><font size = "-1">
<div align="center"><b><font>4.1. Особенности и синтаксис предложений модификации</font></b></div><font size = "-1">

<p align=justify>Модификация данных может выполняться с помощью предложений DELETE (удалить), INSERT (вставить) и UPDATE (обновить). Подобно предложению SELECT они могут оперировать как базовыми таблицами, так и представлениями. Однако по ряду причин не все представления являются обновляемыми. Пока зафиксируем этот факт, отложив описание представлений и особенностей их обновления до главы 5, но будем помнить, что термин "представление" относится только к обновляемым представлениям.</p>
<p align=justify>Предложение DELETE имеет формат</p>
<pre>
DELETE
FROM   базовая таблица | представление
[WHERE фраза];
</pre>
<p align=justify>и позволяет удалить содержимое всех строк указанной таблицы (при отсутствии WHERE фразы) или тех ее строк, которые выделяются WHERE фразой.</p>
<p align=justify>Предложение INSERT имеет один из следующих форматов:</p>
<pre>
INSERT
INTO    {базовая таблица | представление} 
                [(столбец [,столбец] ...)]
VALUES ({константа | переменная}
           [,{константа | переменная}] ...);
</pre>
<p align=justify>или</p>
<pre>
INSERT
INTO {базовая таблица | представление} 
             [(столбец [,столбец] ...)]
     подзапрос;
</pre>
<p align=justify>В первом формате в таблицу вставляется строка со значениями полей, указанными в перечне фразы VALUES (значения), причем i-е значение соответствует i-му столбцу в списке столбцов (столбцы, не указанные в списке, заполняются NULL-значениями). Если в списке VALUES фразы указаны все столбцы модифицируемой таблицы и порядок их перечисления соответствует порядку столбцов в описании таблицы, то список столбцов в фразе INTO можно опустить. Однако не советуем этого делать, так как при изменении описания таблицы (перестановка столбцов или изменение их числа) придется переписывать и INSERT предложение.</p>
<p align=justify>Во втором формате сначала выполняется подзапрос, т.е. по предложению SELECT в памяти формируется рабочая таблица, а потом строки рабочей таблицы загружаются в модифицируемую таблицу. При этом i-й столбец рабочей таблицы (i-й элемент списка SELECT) соответствует i-му столбцу в списке столбцов модифицируемой таблицы. Здесь также при выполнении указанных выше условий может быть опущен список столбцов фразы INTO.</p>
<p align=justify>Предложение UPDATE также имеет два формата. Первый из них:</p>
<pre>
UPDATE (базовая таблица | представление}
SET	столбец = значение [, столбец = значение] ...
[WHERE фраза]
</pre>
<p align=justify>где значение - это</p>
<pre>
столбец | выражение | константа | переменная
</pre>
<p align=justify>и может включать столбцы лишь из обновляемой таблицы, т.е. значение одного из столбцов модифицируемой таблицы может заменяться на значение ее другого столбца или выражения, содержащего значения нескольких ее столбцов, включая изменяемый.</p>
<p align=justify>При отсутствии WHERE фразы обновляются значения указанных столбцов во всех строках модифицируемой таблицы. WHERE фраза позволяет сократить число обновляемых строк, указывая условия их отбора.</p>
<p align=justify>Второй формат описывает предложение, позволяющее производить обновление значений модифицируемой таблицы по значениям столбцов из других таблиц. К сожалению в ряде СУБД эти форматы отличаются друг от друга и от стандарта. Для примера приведем один из таких форматов:</p>
<pre>
UPDATE  {базовая таблица | представление}
SET	столбец = значение [, столбец = значение] ...
FROM    {базовая таблица | представление} [псевдоним],
        {базовая таблица | представление} [псевдоним]
      [,{базовая таблица | представление} 
	                            [псевдоним]] ...
[WHERE  фраза]
</pre>
<p align=justify>Здесь перечень таблиц фразы FROM содержит имя модифицируемой таблицы и тех таблиц, значения столбцов которых используются для обновления. При этом, естественно, таблицы должны быть связаны между собой в WHERE фразе (см.п.<a href=3-2-3.htm>3.2.3</a>), которая, кроме того, служит для указания условий отбора обновляемых строк модифицируемой таблицы.</p>
<p align=justify>В значениях, находящихся в правых частях равенств фразы SET, следует уточнять имена используемых столбцов, предваряя их именем таблицы (псевдонима).</p>

	
<p align="center">
<a href="3-6.htm">3.6</a> | <a href="index.htm">Содержание</a> | <a href="4-2.htm">4.2</a>
</p>

</body>
</html>
