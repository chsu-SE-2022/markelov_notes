<html>
<head>
   <title>Запросы, использующие EXISTS</title>

</head>

<body background="fon.jpg">
<div align="center"><b><font>3.3.6. Запросы, использующие EXISTS </font></b></div><font size = "-1">

<p align=justify>Квантор EXISTS (существует) - понятие, заимствованное из формальной логики. В языке SQL предикат с квантором существования представляется выражением EXISTS (SELECT * FROM ...).</P>
<p align=justify>Такое выражение считается истинным только тогда, когда результат вычисления "SELECT * FROM ..." является непустым множеством, т.е. когда существует какая-либо запись в таблице, указанной во фразе FROM подзапроса, которая удовлетворяет условию WHERE подзапроса. (Практически этот подзапрос всегда будет коррелированным множеством.)</P>
<p align=justify>Рассмотрим примеры. Выдать названия поставщиков, поставляющих продукт с номером 11.</P>
<TABLE width=100%>
<TR><TH></TH><TH align=left>Результат:</TH></TR>
<TR valign=top><TD><PRE>  SELECT	Название
FROM	Поставщики
WHERE	EXISTS
	(	SELECT	*
		FROM	Поставки
		WHERE	ПС = Поставщики.ПС
		AND	ПР = 11 );</PRE></TD>
		
<TD><TABLE>
<TR><TH>Название</TH></TR>
<TR><TD>СЫТНЫЙ</TD></TR>
<TR><TD>УРОЖАЙ</TD></TR>
<TR><TD>КОРЮШКА</TD></TR>
<TR><TD>ЛЕТО</TD></TR></TABLE>
</TD>
</TR>
</TABLE>

<p align=justify>Система последовательно выбирает строки таблицы Поставщики, выделяет из них значения столбцов Название и ПС, а затем проверяет, является ли истинным условие существования, т.е. су-ществует ли в таблице Поставки хотя бы одна строка со значением ПР=11 и значением ПС, равным значению ПС, выбранному из таблицы Поставщики. Если условие выполняется, то полученное значение столбца Название включается в результат.</P>
<p align=justify>Предположим, что первые значения полей Название и ПС равны, соответственно, 'СЫТНЫЙ' и 1. Так как в таблице Поставки есть строка с ПР=11 и ПС=1, то значение 'СЫТНЫЙ' должно быть включено в результат.</P>
<p align=justify>Хотя этот первый пример только показывает иной способ формулировки запроса для задачи, решаемой и другими путями (с помощью оператора IN или соединения), EXISTS представляет собой одну из наиболее важных возможностей SQL. Фактически любой запрос, который выражается через IN, может быть альтернативным образом сформулирован также с помощью EXISTS. Однако обратное высказывание несправедливо.</P>
<p align=justify>Выдать название и статус поставщиков, не поставляющих продукт с номером 11.</P>
<TABLE width=100%>
<TR><TH></TH><TH align=left>Результат:</TH></TR>
<TR valign=top><TD><PRE>  SELECT	Название, Статус
  FROM	Поставщики
  WHERE	NOT EXISTS
	(	SELECT	*
		FROM 	Поставки
		WHERE	ПС = Поставщики.ПС
		AND	ПР = 11 );</PRE></TD>
		
<TD>
<TABLE>
<TR><th>Название</TH><th>Статус</TH></TR>
<TR><TD>ПОРТОС</TD><TD>кооператив</TD></TR>
<TR><TD>ШУШАРЫ</TD><TD>совхоз</TD></TR>
<TR><TD>ТУЛЬСКИЙ</TD><TD>универсам</TD></TR>
<TR><TD>ОГУРЕЧИК</TD><TD>ферма</TD></TR>
</TABLE>
</TD>
</TR>
</TABLE>

<p align="center">
<a href="3-3-5.htm">3.3.5</a> | <a href="index.htm">Содержание</a> | <a href="3-3-7.htm">3.3.7</a>
</p>

</body>
</html>
