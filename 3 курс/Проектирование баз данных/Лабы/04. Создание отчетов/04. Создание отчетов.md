ERwin позволяет создавать собственные отчеты, обобщающие графическую информацию, которая содержится в диаграмме ERwin. Для создания отчета используется команда меню **Report**. Например, для создания отчета по сущностям дайте команду “Entity Report...”. Можно выбрать один из распространенных форматов, например формат колонок (columnar), когда информация появляется под соответствующим заголовком, или формат меток (Labeled), когда информация появляется под соответствующей меткой (напр., Entity Name: CUSTOMER).  
ERwin определяет, как будет форматироваться отчет, исходя из режимов форматирования, которые задается в редакторе Report.  
**Типы отчетов**  
ERwin позволяет создавать отчеты четырех разных типов: Entity Report, Attribute Report, Relationhip Report и Constraint Report. Ниже приводится таблица, в которую включены все доступные возможности, а также расширения файлов для каждого типа отчетов, создаваемых в ERwin.  

| **Тип отчета** | **Расширение файла** | **Доступные режимы**                                                                                                                                                                                                                                                                   |
| -------------- | -------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Entity         | `.ERE`               | Детали сущности: имя, определение, notes и т. п.  <br>Определения связанных с сущностью атрибутов и связей.  <br>Параметры таблицы физической модели.  <br>Критерии валидации.  <br>Триггер Default или Entity OvERide.                                                                |
| Attribute      | `.ERA`               | Детали атрибута: имя, базовое имя, имя роли и знак ключа.  <br>Оглавление и определения колонок таблицы физической модели.  <br>Значения связанных с атрибутом ограничений.                                                                                                            |
| Relationship   | `.ER`                | Детали связи: глагольная фраза, тип связи, имена родительской и дочерней сущностей.  <br>Значения режимов нулевых значений, ссылочной целостности и кардинальность.  <br>Характеристики физической модели: физические имена родительской, дочерней сущностей и связи.                  |
| Constraint     | `.ERC`               | Тип отчета: выберите тип Domain, Default или Validation.  <br>Имя домена, тип данных и режим нулевых значений.  <br>Имя или значение по умолчанию.  <br>Имя атрибута логической модели.  <br>Имя колонки, тип данных колонки и имя таблицы физической модели.  <br>Критерии валидации. |
  
**Режимы форматирования отчетов**  
ERwin поддерживает несколько распространенных форматов, в соответствии с которыми он выводит на экран данные отчета. Ниже приводится таблица, где кратко описаны все режимы.

| **Режим форматирования отчета** | **Что делает этот режим**                                                                                                                                                                                                            |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Report Format**               |                                                                                                                                                                                                                                      |
| Labeled                         | Обозначает каждое значение в отчете при помощи метки (например, `Attribute Name: customer_name`).                                                                                                                                    |
| Fixed                           | Связывает каждое значение в отчете с фиксированным заголовком колонки.                                                                                                                                                               |
| Tab Delimited                   | Использует метки табуляции для разделения значений в отчете.                                                                                                                                                                         |
| Comma Delimited                 | Использует запятую для разделения значений в отчете.                                                                                                                                                                                 |
| DDE Table                       | Пересылает данные отчета в табличной форме в другое приложение.                                                                                                                                                                      |
| **Multi-Valued Format**         |                                                                                                                                                                                                                                      |
| Repeating Group                 | Помещает связанные между собой значения в одну ячейку таблицы, после каждого значения ставит знак + (плюс).                                                                                                                          |
| Filled                          | Поторяет значение родителя для каждого экземпляра повторяющегося дочернего значения.                                                                                                                                                 |
| Header                          | Выводит родительское значение на экран только один раз для всех связанных с ним дочерних значений.                                                                                                                                   |
| Merge                           | Определяет, будет ли первая строка значения сливаться с родительским значением. Чтобы слить значения, поставьте метку Х в окно. Чтобы оставить родительское значение в своей строке, уберите Х из окна.                              |
| Remove Newline                  | Убирает символ перехода на новую строку из конца каждой строки отчета. Используйте этот режим для того, чтобы свяязанные между собой значения попали на одну строку, а не на новую строку, при экспорте отчета с использованием DDE. |
  
**Работа в редакторе Report**  
Когда ERwin впервые открывает редактор Report, он автоматически загружает определение отчета, устанавливаемое по умолчанию для выбранного Вами типа отчета. ERwin прсваивает имя по умолчанию (напр., Attribute Report), задает режимы содержания (напр., Attribute Name) и форматирования (напр., labeled и merge - для заголовка). Вы можете изменить режимы и определения, задаваемые по умолчанию, включая свои собственные. Когда Вы нажимаете одну из управляющих кнопок внизу редактора, ERwin сразу же генерирует отчет, состоящий из текстовых данных, взятых из диаграммы, основываясь на режимах содержания и форматирования, заданных Вами.  
Порядок, в котором Вы задаете режимы, будет определять тот порядок, в котором в отчете появятся заголовки. Например, если вы задали режимы в такой последовательности: 1) “Attribute Name” 2) “Base name” 3) “Role Name”, то заголовки или метки в отчете будут расположены в том же порядке.  
Если Вы хотите получить какой-то отчет только один раз, просто поставьте метки в окнах нужных Вам режимов и нажмите кнопку “Print...”. Если Вы хотите сохранить выбранные Вами режимы в качестве спецификации, которую можно было бы потом еще использовать для повторной генерации этого же отчета, введите новое имя определения отчета в текстовое окно “Report” в верхней части окна-диалога и нажмите кнопку “New” для сохранения определения отчета на диске, как части текущей диаграммы.  
Чтобы изменить определение отчета, выберите определение отчета, которое Вы хотите изменить, из списка “Report”, расположенного в верхней части окна-диалога. Вы можете изменить имя отчета и (или) задать новые или другие режимы. Нажмите кнопку “Update” для сохранения изменений.  
Чтобы удалить определение отчета, выберите определение отчета, которое Вы хотите удалить, из списка “Report” и нажмите кнопку “Delete”. Отвечайте “Yes”, когда ERwin попросит Вас подтвердить удаление. ERwin сразу же удаляет определение отчета. Файлы отчетов, созданные с использованием удаленного определения отчета, сохраняются.  
Вы можете использовать кнопку “Preview...” в нижней части редактора Report, чтобы просмотреть содержимое отчета. Когда Вы получите желаемый результат, нажмите кнопку “Print...”, чтобы распечатать отчет, или кнопку “Report...”, чтобы сохранить выходной файл отчета на диске.  
Когда Вы нажимаете кнопку “Close...”, расположенную внизу в редакторе Report, ERwin сохраняет определение отчета, так что Вы можете использовать его повторно, не задавая снова те же самые режимы каждый раз, когда Вы захотите сгенерировать данные отчета.  
**Выбор сущностей для отчета**  
По умолчанию ERwin генерирует отчет по всем сущностям текущей области. Если Вы хотите включить в отчет только какие-то отдельные сущности, нажмите кнопку “Filter...”. ERwin открывает редактор Report Filter, содержащий список всех объектов текущей области. Список находится в окне “Report Filter”. Исключите те объекты, которые Вы не собираетесь включать в отчет, с помощью кнопок “Remove” и “Remove All”. Если Вы передумаете, включите объекты, исключенные Вами по неосторожности, с помощью кнопок “Add” и “Add All”.  
**Просмотр отчета**  
Прежде чем распечатать отчет, Вы можете просмотреть его в окне Preview редактора Report. Вы можете вводить текст непосредственно в окно Preview, чтобы снабдить отчет полезной информацией и комментариями.  
Чтобы открыть окно Preview, нажмите кнопку “Preview...”. ERwin откроет окно Preview и покажет в нем текущий отчет. Вы можете использовать управляющие функции окна для просмотра всего текста отчетов и изменения размера окна.  
Если Вы печатаете или сохраняте отчет, используя для этого управляющие функции окна Preview, ERwin включает ту информацию, которую Вы ввели сами, в выходной текст отчета. Однако, когда Вы закрываете окно Preview, то эта информация пропадает.  
**Сохранение файла отчета**  
Отчет в ERwin состоит из двух элементов: **определение отчета,** в котором заданы режимы содержания и форматирования отчета, и **выходной файл отчета**, содержащий реальные данные, сгенерированные определением отчета. Определение отчета можно сохранить, как часть текущей диаграммы (подобно области), вводя имя отчета и нажимая кнопку “New” или “Update” в редакторе Report. Выходной файл можно сохранить в отдельном текстовом файле в формате ASCII, для этого нужно нажать кнопку “Report...” в редакторе Report, а затем задать имя файла и path в окне-диалоге Save As.  
Вы можете записать выходной файл отчета на диск, используя для этого кнопку “Report...” в редакторе Report или в окне Preview. Когда Вы записываете отчет на диск, выходной файл отчета, или данные, сохраняются в формате ASCII. ERwin использует расширение файла отчета, задаваемое по умолчанию (Entity=.ERE, Attribute=.ERA, Relationship=.ER, Constraint=.ERC) и предоставляет Вам ввести имя отчета.  
Для записи отчета на диск нажмите кнопку “Report...”. ERwin выводит на экран диалог `“Generate <Report> Type”` с расширением файла, задаваемым по умолчанию. Введите уникальное имя отчета и нажмите кнопку “ОК”.  
ERwin сохраняет данные отчета в отдельном файле. Вы можете открыть отчет ERwin из Microsoft Word, WordPerfect, Excel или любого другого приложения, занимающегося обработкой текстов или таблиц, которое может читать файлы ASCII.  
**Как создать отчет**  
1. Дайте одну из команд меню **Report**: “Entity Report...”, “Attribute Report...”, “Relationship Report...” или “Constraint Report...” для входа в соответствующий редактор Report.
2. Если Вы хотите выбрать какие-то отдельные сущности из текущей области и включить в отчет только их, нажмите кнопку “Filter...” в нижней части окна-диалога. ERwin открывает редактор Report Filter, в котором есть список всех сущностей области - Report Filter. Исключите из списка сущности, которые Вы не собираетесь включать в отчет, используя кнопки “Remove” и “Remove All”. Если Вы передумаете, восстановите сущности, исклюенные по неосторожности, с помощью кнопок “Add” и “Add All”. Нажмите кнопку “Close” для возвращения в редактор Report.
3. Задайте режимы, определяющие содержание и формат отчета.  
	Чтобы включить режим, поставьте Х в окно рядом с названием режима.
	Чтобы выключить включенный режим, уберите Х из окна режима.
4. Чтобы просмотреть содержание и формат отчета в ERwin, нажмите кнопку “Preview”, расположенную внизу диалога. ERwin открывает окно Report Preview. Закончив просматривать отчет, нажмите кнопку “Close” для возвращения в редактор Report.
5. Если это необходимо, повторите п. 3-4 для изменения режимов содржания и форматирования, затем снова просмотрите отчет.
6. Закончив формирование содержания и форматирование отчета, нажмите кнопку “Print” для вывода отчета на печать, нажмите кнопку “Report” для записи отчета на диск.
7. Если Вы хотите сохранить определение текущего отчета, щелкните по текстовому окну Report, расположенному наверху диалога, и используйте стандартные клавиши редактирования текста для удаления имени отчета, присвоенного по умолчанию. После этого введите новое имя отчета и нажмите кнопку “New” для сохранения нового определения отчета.
8. Закончив работу в редакторе Report, нажмите кнопку “Close” для возвращения в окно диаграммы.
  
**Как изменить определение отчета**
1. Дайте одну из команд меню **Report**: “Entity Report...”, “Attribute Report...”, “Relationship Report...” или “Constraint Report...” для входа в соответствующий редактор Report.
2. Щелкните по стрелке “вниз” рядом со списком “Report”, расположенным наверху диалога, и выберите отчет, который Вы хотите изменить.
3. Задайте режимы, определяющие содержание и формат отчета.  
	Чтобы изменить порядок расположения колонок, щелкните по тем колонкам, которые Вы хотите переставить местами (отмените выбор). Затем, щелкнув, снова выберите их в нужном Вам порядке.  
	Представьте, например, что заголовки меток или колонок для отчета расположены в таком порядке: 1) Attribute Name 2) Base Name 3) Definition. Если Вы хотите поменять местами Base Name и Definition, щелкните и уберите Х из окон рядом с обоими заголовками. Затем щелкните, поставив метку сначала в окно Definition, а затем в окно Base Namе. ERwin переставит колонки или метки: 1) Attribute Name 2) Attribute Definition 3) Attribute Base Name.
4. Чтобы просмотреть содержание и формат отчета в ERwin, нажмите кнопку “Preview”, расположенную внизу диалога. ERwin открывает окно Report Preview. Закончив просматривать отчет, нажмите кнопку “Close” для возвращения в редактор Report.
5. Если это необходимо, повторите п. 3-4 для изменения режимов содржания и форматирования, затем снова просмотрите отчет.
6. Закончив формирование содержания и форматирование отчета, нажмите кнопку “Update” для сохранения определения отчета. Нажмите кнопку “Print” для вывода отчета на печать, или кнопку “Report” для записи отчета на диск, или кнопку “Close” для возвращения в окно диаграммы.
  
Порядок, в котором Вы задаете режимы для отчета, определяет тот порядок, в котором будет располагаться информация в отчете.  
Если Вы задали режим “Fixed Column” или “DDE Table” в групповом окне Report Format, то кнопки Print и Preview на экране становятся серыми. Чтобы просмотреть отчет в формате Fixed Column, экспортируйте отчет в другое приложение, пользуясь режимом DDE Table. См. далее в этой главе разд. “Использование отчетов ERwin в других приложениях”.  
**Как записать выходной файл отчета на диск**  
1. Нажмите кнопку “Report...”, расположенную в нижней части редактора Report или report Preview.  
	ERwin открывает окно-диалог `“Generate <Report> Type”` с расширением, присваиваемым по умолчанию (напр., `.ERE`, `.ERA`, `.ER`, `.ERC`).
2. Введите уникальное имя отчета и нажмите “ОК”.  
	ERwin записывает файл отчета на диск и выходит в редактор Report.
  
**Как распечатать отчет**
1. Нажмите кнопку “Print...”, расположенную в нижней части редактора Report или report Preview.  
	ERwin сразу же посылает отчет на печать.
  
**Как удалить определение отчета**
1. Дайте одну из команд меню **Report**: “Entity Report...”, “Attribute Report...”, “Relationship Report...” или “Constraint Report...” для входа в соответствующий редактор Report.
2. Щелкните по стрелке “вниз” рядом со списком “Report”, расположенным наверху диалога, и выберите отчет, который Вы хотите удалить.
3. Нажмите кнопку “Delete” для удаления определения отчета. После этого нажмите кнопку “Close” для возвращения в окно диаграммы.
  
Если Вы удаляете определение отчета в редакторе Report, это удаление не отражается на файлах отчетов, созданных с использованием этого определения, которые сохраняются.  
**Использование отчетов ERwin с другими приложениями**  
ERwin предоставляет Вам несколько возможностей для работы с данными отчетов ERwin в других приложениях.  
Если Вы задаете режим “DDE Table” в редакторе Report, Вы можете экспортировать выходной отчет ERwin в любое приложение обработки текстов или таблиц, например, в Word, Excel и др.  
Если Вы сохранили отчет ERwin в любом формате (напр., columnar, labeled, tab delimited, comma delimited) в качестве текстового файла (напр., `.ERE`, .`ERA`, `.ER`, `.ERC`), Вы можете открыть этот файл из любого приложения, которое может читать файл ASCII. Когда Вы открываете этот отчет из приложения, Вы можете использовать режимы форматирования, чтобы изменить внешний вид отчета ERwin.  
## Задания
Сформируйте разнообразные отчеты. Каждый отчет сохраните в текстовом файле (`.ERE`, `.ERA`, `.ER`, `.ERC`), а затем откройте файл отчета из приложения, обрабатывающего текстовую информацию или таблицы, такого как Microsoft Word или как Microsoft Excel.  
![Создание отчетов](../../Pictures/ЛБ04_01.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_02.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_03.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_04.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_05.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_06.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_07.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_08.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_09.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_10.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_11.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_12.%20Создание%20отчета.png)  
![Создание отчетов](../../Pictures/ЛБ04_13.%20Создание%20отчета.png)  
1. Сформируйте отчет по сущности: задайте режимы, определяющие содержание отчета, в такой последовательности:
	1) Entity Name
	2) Table Name
	3) Alternate Keys
2. Сформируйте отчет по атрибутам: задайте режимы, определяющие содержание отчета, в такой последовательности:
	1) Attribute Name
	2) Column Name
	3) Column Datatype
	4) Entity Usage
	  
	![Создание отчетов](../../Pictures/ЛБ04_14.%20Создание%20отчета.png)  
3. Сформируйте отчет по связям: задайте режимы, определяющие содержание отчета, в такой последовательности:
	1) Parent Entity
	2) Child Entity
	3) Logical FK
	4) Verb Phrase
4. Сформируйте отчет по ограничениям: задайте режимы, определяющие содержание отчета, в такой последовательности:
	1) Valid Name
	2) Valid Expr
	3) Valid Value: Def
  
Чтобы сгенерировать отчет по ограничениям, ERwin должен иметь возможность связать выбранный режим содержания для типа отчета (Domain, Default или Diagram) c cоответствующим значением в текущей диаграмме. Например, если Вы задаете “Validation” в качестве Report Type и “Valid Name” в качестве режима содержания отчета, текущая диаграмма должна содержать правило валидации, чтобы ERwin мог сгенерировать отчет.  
Если Вы открываете файл отчета ERwin из текстового процессора, то установки меток табуляции, задаваемые по умолчанию, могут привести к тому, что колонки отчета не будут выравнены. Отрегулируйте метки табуляции, используя возможности, доступные в данном текстовом процессоре.